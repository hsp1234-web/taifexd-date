{"message": "Test database setup: 'valid_data' table created with sample data.", "name": "test_data_transformer", "module": "test_data_transformer", "funcName": "db_connection", "lineno": 30, "pathname": "/app/tests/test_data_transformer.py", "filename": "test_data_transformer.py", "taskName": null, "timestamp": "2025-06-20T16:05:08.669758+08:00", "level": "INFO", "logger_name": "test_data_transformer"}
{"message": "Starting test_data_transformer_integration.", "name": "test_data_transformer", "module": "test_data_transformer", "funcName": "test_data_transformer_integration", "lineno": 39, "pathname": "/app/tests/test_data_transformer.py", "filename": "test_data_transformer.py", "taskName": null, "timestamp": "2025-06-20T16:05:08.670853+08:00", "level": "INFO", "logger_name": "test_data_transformer"}
{"message": "Attempting to run data transformation.", "name": "test_data_transformer", "module": "test_data_transformer", "funcName": "test_data_transformer_integration", "lineno": 48, "pathname": "/app/tests/test_data_transformer.py", "filename": "test_data_transformer.py", "taskName": null, "timestamp": "2025-06-20T16:05:08.671062+08:00", "level": "INFO", "logger_name": "test_data_transformer"}
{"message": "Data transformation process completed.", "name": "test_data_transformer", "module": "test_data_transformer", "funcName": "test_data_transformer_integration", "lineno": 50, "pathname": "/app/tests/test_data_transformer.py", "filename": "test_data_transformer.py", "taskName": null, "timestamp": "2025-06-20T16:05:08.689343+08:00", "level": "INFO", "logger_name": "test_data_transformer"}
{"message": "Query for 'transformed_data' table existence returned: [('transformed_data',)]", "name": "test_data_transformer", "module": "test_data_transformer", "funcName": "test_data_transformer_integration", "lineno": 54, "pathname": "/app/tests/test_data_transformer.py", "filename": "test_data_transformer.py", "taskName": null, "timestamp": "2025-06-20T16:05:08.702129+08:00", "level": "INFO", "logger_name": "test_data_transformer"}
{"message": "Transformed data fetched:\n   id   name  amount  timestamp  absolute_amount transaction_type\n0   1  test1     100 2023-01-01              100           credit\n1   2  test2    -200 2023-01-02              200            debit\n2   3  test3     300 2023-01-03              300           credit\n3   4  test4    -400 2023-01-04              400            debit", "name": "test_data_transformer", "module": "test_data_transformer", "funcName": "test_data_transformer_integration", "lineno": 59, "pathname": "/app/tests/test_data_transformer.py", "filename": "test_data_transformer.py", "taskName": null, "timestamp": "2025-06-20T16:05:08.711591+08:00", "level": "INFO", "logger_name": "test_data_transformer"}
{"message": "Assertion for 'absolute_amount' passed.", "name": "test_data_transformer", "module": "test_data_transformer", "funcName": "test_data_transformer_integration", "lineno": 70, "pathname": "/app/tests/test_data_transformer.py", "filename": "test_data_transformer.py", "taskName": null, "timestamp": "2025-06-20T16:05:08.712344+08:00", "level": "INFO", "logger_name": "test_data_transformer"}
{"message": "Assertion for 'transaction_type' passed.", "name": "test_data_transformer", "module": "test_data_transformer", "funcName": "test_data_transformer_integration", "lineno": 72, "pathname": "/app/tests/test_data_transformer.py", "filename": "test_data_transformer.py", "taskName": null, "timestamp": "2025-06-20T16:05:08.712934+08:00", "level": "INFO", "logger_name": "test_data_transformer"}
{"message": "All assertions for transformed data passed.", "name": "test_data_transformer", "module": "test_data_transformer", "funcName": "test_data_transformer_integration", "lineno": 74, "pathname": "/app/tests/test_data_transformer.py", "filename": "test_data_transformer.py", "taskName": null, "timestamp": "2025-06-20T16:05:08.713104+08:00", "level": "INFO", "logger_name": "test_data_transformer"}
{"message": "test_data_transformer_integration completed successfully.", "name": "test_data_transformer", "module": "test_data_transformer", "funcName": "test_data_transformer_integration", "lineno": 85, "pathname": "/app/tests/test_data_transformer.py", "filename": "test_data_transformer.py", "taskName": null, "timestamp": "2025-06-20T16:05:08.713234+08:00", "level": "INFO", "logger_name": "test_data_transformer"}
{"message": "Test database teardown: Closing connection.", "name": "test_data_transformer", "module": "test_data_transformer", "funcName": "db_connection", "lineno": 32, "pathname": "/app/tests/test_data_transformer.py", "filename": "test_data_transformer.py", "taskName": null, "timestamp": "2025-06-20T16:05:08.714043+08:00", "level": "INFO", "logger_name": "test_data_transformer"}
{"message": "Failing DB transformer setup: Connected to a clean in-memory DB (no 'valid_data').", "name": "test_data_transformer", "module": "test_data_transformer", "funcName": "failing_db_transformer", "lineno": 99, "pathname": "/app/tests/test_data_transformer.py", "filename": "test_data_transformer.py", "taskName": null, "timestamp": "2025-06-20T16:05:08.730459+08:00", "level": "INFO", "logger_name": "test_data_transformer"}
{"message": "Starting test_data_transformer_error_handling.", "name": "test_data_transformer", "module": "test_data_transformer", "funcName": "test_data_transformer_error_handling", "lineno": 111, "pathname": "/app/tests/test_data_transformer.py", "filename": "test_data_transformer.py", "taskName": null, "timestamp": "2025-06-20T16:05:08.731287+08:00", "level": "INFO", "logger_name": "test_data_transformer"}
{"message": "Attempting to run data transformation (expected to fail).", "name": "test_data_transformer", "module": "test_data_transformer", "funcName": "test_data_transformer_error_handling", "lineno": 115, "pathname": "/app/tests/test_data_transformer.py", "filename": "test_data_transformer.py", "taskName": null, "timestamp": "2025-06-20T16:05:08.731587+08:00", "level": "INFO", "logger_name": "test_data_transformer"}
{"message": "Transformation failed as expected. Exception: Catalog Error: Table with name valid_data does not exist!\nDid you mean \"duckdb_databases\"?\n\nLINE 10:                 FROM valid_data\n                              ^", "name": "test_data_transformer", "module": "test_data_transformer", "funcName": "test_data_transformer_error_handling", "lineno": 118, "pathname": "/app/tests/test_data_transformer.py", "filename": "test_data_transformer.py", "taskName": null, "timestamp": "2025-06-20T16:05:08.743635+08:00", "level": "INFO", "logger_name": "test_data_transformer"}
{"message": "Failing DB transformer teardown: Closing connection.", "name": "test_data_transformer", "module": "test_data_transformer", "funcName": "failing_db_transformer", "lineno": 101, "pathname": "/app/tests/test_data_transformer.py", "filename": "test_data_transformer.py", "taskName": null, "timestamp": "2025-06-20T16:05:08.816753+08:00", "level": "INFO", "logger_name": "test_data_transformer"}
{"message": "Test database setup: 'valid_data' table created with sample data.", "name": "test_data_transformer", "module": "test_data_transformer", "funcName": "db_connection", "lineno": 30, "pathname": "/app/tests/test_data_transformer.py", "filename": "test_data_transformer.py", "taskName": null, "timestamp": "2025-06-20T16:05:26.184741+08:00", "level": "INFO", "logger_name": "test_data_transformer"}
{"message": "Starting test_data_transformer_integration.", "name": "test_data_transformer", "module": "test_data_transformer", "funcName": "test_data_transformer_integration", "lineno": 39, "pathname": "/app/tests/test_data_transformer.py", "filename": "test_data_transformer.py", "taskName": null, "timestamp": "2025-06-20T16:05:26.185715+08:00", "level": "INFO", "logger_name": "test_data_transformer"}
{"message": "Attempting to run data transformation.", "name": "test_data_transformer", "module": "test_data_transformer", "funcName": "test_data_transformer_integration", "lineno": 48, "pathname": "/app/tests/test_data_transformer.py", "filename": "test_data_transformer.py", "taskName": null, "timestamp": "2025-06-20T16:05:26.185909+08:00", "level": "INFO", "logger_name": "test_data_transformer"}
{"message": "Data transformation process completed.", "name": "test_data_transformer", "module": "test_data_transformer", "funcName": "test_data_transformer_integration", "lineno": 50, "pathname": "/app/tests/test_data_transformer.py", "filename": "test_data_transformer.py", "taskName": null, "timestamp": "2025-06-20T16:05:26.200888+08:00", "level": "INFO", "logger_name": "test_data_transformer"}
{"message": "Query for 'transformed_data' table existence returned: [('transformed_data',)]", "name": "test_data_transformer", "module": "test_data_transformer", "funcName": "test_data_transformer_integration", "lineno": 54, "pathname": "/app/tests/test_data_transformer.py", "filename": "test_data_transformer.py", "taskName": null, "timestamp": "2025-06-20T16:05:26.216415+08:00", "level": "INFO", "logger_name": "test_data_transformer"}
{"message": "Transformed data fetched:\n   id   name  amount  timestamp  absolute_amount transaction_type\n0   1  test1     100 2023-01-01              100           credit\n1   2  test2    -200 2023-01-02              200            debit\n2   3  test3     300 2023-01-03              300           credit\n3   4  test4    -400 2023-01-04              400            debit", "name": "test_data_transformer", "module": "test_data_transformer", "funcName": "test_data_transformer_integration", "lineno": 59, "pathname": "/app/tests/test_data_transformer.py", "filename": "test_data_transformer.py", "taskName": null, "timestamp": "2025-06-20T16:05:26.226589+08:00", "level": "INFO", "logger_name": "test_data_transformer"}
{"message": "Assertion for 'absolute_amount' passed.", "name": "test_data_transformer", "module": "test_data_transformer", "funcName": "test_data_transformer_integration", "lineno": 70, "pathname": "/app/tests/test_data_transformer.py", "filename": "test_data_transformer.py", "taskName": null, "timestamp": "2025-06-20T16:05:26.227337+08:00", "level": "INFO", "logger_name": "test_data_transformer"}
{"message": "Assertion for 'transaction_type' passed.", "name": "test_data_transformer", "module": "test_data_transformer", "funcName": "test_data_transformer_integration", "lineno": 72, "pathname": "/app/tests/test_data_transformer.py", "filename": "test_data_transformer.py", "taskName": null, "timestamp": "2025-06-20T16:05:26.227893+08:00", "level": "INFO", "logger_name": "test_data_transformer"}
{"message": "All assertions for transformed data passed.", "name": "test_data_transformer", "module": "test_data_transformer", "funcName": "test_data_transformer_integration", "lineno": 74, "pathname": "/app/tests/test_data_transformer.py", "filename": "test_data_transformer.py", "taskName": null, "timestamp": "2025-06-20T16:05:26.228056+08:00", "level": "INFO", "logger_name": "test_data_transformer"}
{"message": "test_data_transformer_integration completed successfully.", "name": "test_data_transformer", "module": "test_data_transformer", "funcName": "test_data_transformer_integration", "lineno": 85, "pathname": "/app/tests/test_data_transformer.py", "filename": "test_data_transformer.py", "taskName": null, "timestamp": "2025-06-20T16:05:26.228184+08:00", "level": "INFO", "logger_name": "test_data_transformer"}
{"message": "Test database teardown: Closing connection.", "name": "test_data_transformer", "module": "test_data_transformer", "funcName": "db_connection", "lineno": 32, "pathname": "/app/tests/test_data_transformer.py", "filename": "test_data_transformer.py", "taskName": null, "timestamp": "2025-06-20T16:05:26.228913+08:00", "level": "INFO", "logger_name": "test_data_transformer"}
{"message": "Failing DB transformer setup: Connected to a clean in-memory DB (no 'valid_data').", "name": "test_data_transformer", "module": "test_data_transformer", "funcName": "failing_db_transformer", "lineno": 99, "pathname": "/app/tests/test_data_transformer.py", "filename": "test_data_transformer.py", "taskName": null, "timestamp": "2025-06-20T16:05:26.245924+08:00", "level": "INFO", "logger_name": "test_data_transformer"}
{"message": "Starting test_data_transformer_error_handling.", "name": "test_data_transformer", "module": "test_data_transformer", "funcName": "test_data_transformer_error_handling", "lineno": 111, "pathname": "/app/tests/test_data_transformer.py", "filename": "test_data_transformer.py", "taskName": null, "timestamp": "2025-06-20T16:05:26.246771+08:00", "level": "INFO", "logger_name": "test_data_transformer"}
{"message": "Attempting to run data transformation (expected to fail).", "name": "test_data_transformer", "module": "test_data_transformer", "funcName": "test_data_transformer_error_handling", "lineno": 115, "pathname": "/app/tests/test_data_transformer.py", "filename": "test_data_transformer.py", "taskName": null, "timestamp": "2025-06-20T16:05:26.247014+08:00", "level": "INFO", "logger_name": "test_data_transformer"}
{"message": "Transformation failed as expected. Exception: Catalog Error: Table with name valid_data does not exist!\nDid you mean \"duckdb_databases\"?\n\nLINE 10:                 FROM valid_data\n                              ^", "name": "test_data_transformer", "module": "test_data_transformer", "funcName": "test_data_transformer_error_handling", "lineno": 118, "pathname": "/app/tests/test_data_transformer.py", "filename": "test_data_transformer.py", "taskName": null, "timestamp": "2025-06-20T16:05:26.258800+08:00", "level": "INFO", "logger_name": "test_data_transformer"}
{"message": "test_data_transformer_error_handling completed successfully.", "name": "test_data_transformer", "module": "test_data_transformer", "funcName": "test_data_transformer_error_handling", "lineno": 124, "pathname": "/app/tests/test_data_transformer.py", "filename": "test_data_transformer.py", "taskName": null, "timestamp": "2025-06-20T16:05:26.258953+08:00", "level": "INFO", "logger_name": "test_data_transformer"}
{"message": "Failing DB transformer teardown: Closing connection.", "name": "test_data_transformer", "module": "test_data_transformer", "funcName": "failing_db_transformer", "lineno": 101, "pathname": "/app/tests/test_data_transformer.py", "filename": "test_data_transformer.py", "taskName": null, "timestamp": "2025-06-20T16:05:26.259546+08:00", "level": "INFO", "logger_name": "test_data_transformer"}
